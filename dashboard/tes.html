<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Dashboard Peserta â€” LMS (Auto compute)</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Flatpickr -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />

    <style>
      :root {
        --brand: #a80308;
        --muted: #6b7280;
        --card-shadow: 0 10px 30px rgba(2, 6, 23, 0.06);
        --header-bg: #ffdab3;
      }
      body {
        font-family: "Inter", sans-serif;
        color: #111827;
        background: #f6f6f7;
      }
      .card {
        background: #fff;
        border-radius: 12px;
        box-shadow: var(--card-shadow);
      }
      .progress-fill {
        transition: width 350ms ease;
      }

      @media (max-width: 1024px) {
        .lg\\:col-span-8 {
          grid-column: span 8 / span 8;
        }
        .lg\\:col-span-4 {
          grid-column: span 4 / span 4;
        }
      }
      /* legend */
      .legend-dot {
        width: 10px;
        height: 10px;
        border-radius: 999px;
        display: inline-block;
        margin-right: 8px;
      }

      /* table rounding */
      table {
        border-collapse: separate;
        border-spacing: 0;
        width: 100%;
      }
      thead th:first-child {
        border-top-left-radius: 12px;
      }
      thead th:last-child {
        border-top-right-radius: 12px;
      }
      thead th {
        background: var(--header-bg);
      }

       .progress-mini {
        height: 3px;
        border-radius: 999px;
        background: #BBBBBB;
        overflow: hidden;
      }
      .progress-mini > .fill {
        display: block;
        height: 100%;
        border-radius: 999px;
      }

      /* keep canvas responsive box */
      .donut-wrap {
        width: 180px;
        height: 180px;
      }

      /* ensure tbody rows full-width divide */
      tbody > tr > td {
        background: white;
      }
    </style>
  </head>
  <body>
   <!-- NAVBAR -->
    <nav
      class="flex items-center justify-between px-8 py-4 border-b-2 border-gray-200 mb-4 bg-white"
    >
      <div class="flex items-center font-semibold">
        <img src="../img/logo.png" alt="Logo" class="w-10 mr-2" />
        <a
          href="#"
          class="px-4 py-1 rounded-full font-semibold text-black hover:bg-gray-100"
          >Home</a
        >
        <a
          href="#"
          class="px-4 py-1 rounded-full font-semibold text-black hover:bg-gray-100"
          >Dashboard</a
        >
        <a
          href="#"
          class="px-4 py-1 rounded-full font-semibold text-black hover:bg-gray-100"
          >MyCourse</a
        >
        <a
          href="#"
          class="px-4 py-1 rounded-full font-semibold text-black hover:bg-gray-100"
          >Site Administrator</a
        >
      </div>
      <div class="flex items-center gap-2">
        <img
          src="../img/notif.png"
          alt="notification"
          class="w-6 h-8 rounded-lg mr-10"
        />
        <div class="text-end">
          <p class="font-bold">Nama Pengguna</p>
          <p class="text-gray-400 text-[11px]">Nama Learning Staff</p>
        </div>
        <img src="../img/pp.png" alt="Profile" class="w-12 h-12 rounded-lg" />
      </div>
    </nav>

    <main class="mx-8 mb-12">
<!-- HERO -->
      <section class="flex flex-col gap-6 h-70 md:flex-row">
        <div
          class="text-white bg-black rounded-2xl flex-3 w-2/3 p-8 my-auto hero"
        >
          <h1 class="mb-3 max-w-4xl text-4xl font-bold capitalize">
            Alur proses pembelian dan pelunasan cabang
          </h1>
          <p class="mb-3 max-w-3xl text-lg">
            Memberikan pemahaman menyeluruh tentang alur kerja pembelian barang
            hingga proses pembayaran kepada supplier.
          </p>

          <!-- Progress (hero) -->
          <div
            class="flex mb-3 justify-between items-center text-sm text-gray-500 progress-wrapper"
          >
            <div class="w-[90%] bg-gray-200 rounded h-1 relative">
              <div
                class="progress-fill bg-[#a80308] h-1 rounded absolute left-0 top-0"
                style="width: 0%"
                role="progressbar"
                aria-valuemin="0"
                aria-valuemax="100"
                aria-valuenow="0"
              ></div>
            </div>
            <span class="progress-text pl-2">3 / 13</span>
          </div>

          <a
            href="#"
            class="inline-block px-6 py-3 font-semibold text-white transition-colors rounded-lg bg-[#a80308] hover:bg-[#8a0206]"
          >
            Lanjutkan
          </a>
        </div>

        <div class="flex-1 flex flex-col gap-3 capitalize py-4">
          <h3 class="font-bold text-xl">Upcoming</h3>
          <div
            class="border-l-2 border-red-700 pl-2 h-12 flex flex-col justify-center"
          >
            <h6 class="font-semibold text-base">
              Prosedur penanganan komplain konsumen
            </h6>
            <p class="text-xs">12/10/2025</p>
          </div>
          <div
            class="border-l-2 border-red-700 pl-2 h-12 flex flex-col justify-center"
          >
            <h6 class="font-semibold text-base">Prosedur close sales order</h6>
            <p class="text-xs">15/10/2025</p>
          </div>
          <div
            class="border-l-2 border-red-700 pl-2 h-12 flex flex-col justify-center"
          >
            <h6 class="font-semibold text-base">
              Prosedur pengecekan kendaraan harian
            </h6>
            <p class="text-xs">17/10/2025</p>
          </div>
        </div>
      </section>

      <section class="my-6">
        <h2
          class="px-4 py-2 text-lg font-bold text-white bg-[color:var(--brand)] rounded-xl"
        >
          Pelatihan Tersedia
        </h2>

        <!-- controls -->
    <div class="flex items-center justify-between my-3">
          <div class="flex items-center gap-3">
            <label class="text-sm">Bulan Berjalan</label>

            <!-- Date range input (flatpickr mode: range) -->
            <div class="flex items-center gap-2">
              <input
                id="dateRange"
                class="px-3 py-2 rounded-md border border-gray-200 shadow-sm w-72"
                placeholder="Pilih rentang tanggal..."
              />
              <button id="applyRange" class="px-3 py-2 bg-[#a80308] text-white rounded-md">Apply</button>
              <button id="clearRange" class="px-3 py-2 border rounded-md">Clear</button>
            </div>
          </div>

          <div>
            <button id="exportBtn" class="px-3 py-2 text-gray-600">Export</button>
          </div>
        </div>

        <!-- top grid -->
        <div class="grid grid-cols-1 md:grid-cols-8 gap-4 items-stretch">
          <!-- Donut -->
          <div
            class="col-span-1 md:col-span-2 bg-[#FFF4E5] rounded-lg shadow p-4 flex flex-col items-center"
          >
            <div class="w-45 h-45">
              <canvas id="donutChart"></canvas>
            </div>
            <div class="mt-3 flex gap-4 text-xs text-gray-600">
              <div class="flex items-center">
                <span class="legend-dot bg-[#388E3C]"></span
                ><span>Selesai</span>
              </div>
              <div class="flex items-center">
                <span class="legend-dot bg-[#FFB300]"></span
                ><span>Berlangsung</span>
              </div>
              <div class="flex items-center">
                <span class="legend-dot bg-[#A80308]"></span
                ><span>Belum Mulai</span>
              </div>
            </div>
          </div>

          <!-- Stat cards -->
          <div class="col-span-1 md:col-span-4 grid grid-cols-2 gap-4">
            <div
              class="bg-[#FFDAB3] rounded-lg p-4 px-8 shadow h-40 md:h-44 flex flex-col justify-between text-center"
            >
              <div class="text-3xl font-semibold text-black">
                Jumlah Anggota Tim
              </div>
              <div class="text-5xl md:text-6xl font-medium text-black">
                <span id="stat-team">0</span>
              </div>
            </div>

            <div
              class="bg-[#FFF4E5] rounded-lg p-4 px-8 shadow h-40 md:h-44 flex flex-col justify-between text-center"
            >
              <div class="text-3xl font-semibold text-black">
                Pelatihan Berlangsung
              </div>
              <div class="text-5xl md:text-6xl font-medium text-black">
                <span id="stat-running">0</span>
              </div>
            </div>

            <div
              class="bg-[#DFF5E1] rounded-lg p-4 px-8 shadow h-40 md:h-44 flex flex-col justify-between text-center"
            >
              <div class="text-3xl font-semibold text-black">
                Capaian Learning Path
              </div>
              <div class="text-5xl md:text-6xl font-medium text-black">
                <span id="stat-progress">0%</span>
              </div>
            </div>

            <div
              class="bg-[#FFE5E5] rounded-lg p-4 px-8 shadow h-40 md:h-44 flex flex-col justify-between text-center"
            >
              <div class="text-3xl font-semibold text-black">
                Nilai Rata - Rata
              </div>
              <div class="text-5xl md:text-6xl font-medium text-black">
                <span id="stat-score">0.00</span>
              </div>
            </div>
          </div>

          <!-- Leaderboard -->
          <div
            class="col-span-1 md:col-span-2 bg-[#FFDAB3] rounded-lg shadow p-4"
          >
            <h4 class="font-bold text-black text-xl mb-3">Peringkat Saya</h4>
            <ol class="flex flex-col space-y-3 text-sm">
              <li
                class="flex items-center gap-3 border-b border-[#FFB300] py-1"
              >
                <div class="font-semibold w-5 text-end">1.</div>
                <div class="flex-1 px-3">Ervia Oktavia</div>
                <div>300</div>
              </li>
              <li
                class="flex items-center gap-3 border-b border-[#FFB300] py-1"
              >
                <div class="font-semibold w-5 text-end">2.</div>
                <div class="flex-1 px-3">Sarah Amelia</div>
                <div>290</div>
              </li>
              <li class="flex items-center gap-3 py-1">
                <div class="font-semibold w-5 text-end">3.</div>
                <div class="flex-1 px-3">Yoga Lesmana</div>
                <div>280</div>
              </li>
            </ol>
          </div>
        </div>

        <!-- table + progress -->
        <div class="mt-6 grid grid-cols-1 lg:grid-cols-12 gap-4 items-start">
          <div class="lg:col-span-9 card overflow-hidden p-0">
            <table class="min-w-full">
              <thead>
                <tr class="text-left text-sm text-gray-800">
                  <th class="px-6 py-3 text-base font-semibold">Nama</th>
                  <th class="px-6 py-3 text-base font-semibold">Jabatan</th>
                  <th class="px-6 py-3 text-center text-base font-semibold">
                    Harus diikuti
                  </th>
                  <th class="px-6 py-3 text-center text-base font-semibold">
                    Belum dimulai
                  </th>
                  <th class="px-6 py-3 text-center text-base font-semibold">
                    Berlangsung
                  </th>
                  <th class="px-6 py-3 text-center text-base font-semibold">
                    Selesai
                  </th>
                  <th class="px-6 py-3 text-center text-base font-semibold">
                    Nilai Rata - Rata
                  </th>
                </tr>
              </thead>

              <tbody id="membersTbody" class="divide-y divide-[#FFB300]">
                <!-- setiap row bisa punya data-date="YYYY-MM-DD" untuk filter (opsional) -->
                <tr data-date="2025-01-15">
                  <td class="px-6 py-3">Wardah Cahyani</td>
                  <td class="px-6 py-3">Learning</td>
                  <td class="px-6 py-3 text-center">12</td>
                  <td class="px-6 py-3 text-center">1</td>
                  <td class="px-6 py-3 text-center">10</td>
                  <td class="px-6 py-3 text-center">1</td>
                  <td class="px-6 py-3 text-center">8.1</td>
                </tr>

                <tr data-date="2025-02-20">
                  <td class="px-6 py-3">Ervia Oktavia</td>
                  <td class="px-6 py-3">Learning</td>
                  <td class="px-6 py-3 text-center">12</td>
                  <td class="px-6 py-3 text-center">1</td>
                  <td class="px-6 py-3 text-center">9</td>
                  <td class="px-6 py-3 text-center">2</td>
                  <td class="px-6 py-3 text-center">9.0</td>
                </tr>

                <tr data-date="2025-04-10">
                  <td class="px-6 py-3">Sarah Amelia</td>
                  <td class="px-6 py-3">Learning</td>
                  <td class="px-6 py-3 text-center">12</td>
                  <td class="px-6 py-3 text-center">1</td>
                  <td class="px-6 py-3 text-center">10</td>
                  <td class="px-6 py-3 text-center">1</td>
                  <td class="px-6 py-3 text-center">8.8</td>
                </tr>

                <tr data-date="2025-06-05">
                  <td class="px-6 py-3">Yoga Lesmana</td>
                  <td class="px-6 py-3">Learning</td>
                  <td class="px-6 py-3 text-center">12</td>
                  <td class="px-6 py-3 text-center">1</td>
                  <td class="px-6 py-3 text-center">5</td>
                  <td class="px-6 py-3 text-center">6</td>
                  <td class="px-6 py-3 text-center">9.5</td>
                </tr>

                <tr data-date="2025-07-02">
                  <td class="px-6 py-3">Zaki Ammar</td>
                  <td class="px-6 py-3">Learning</td>
                  <td class="px-6 py-3 text-center">12</td>
                  <td class="px-6 py-3 text-center">1</td>
                  <td class="px-6 py-3 text-center">6</td>
                  <td class="px-6 py-3 text-center">5</td>
                  <td class="px-6 py-3 text-center">7.5</td>
                </tr>

                <tr data-date="2025-03-03">
                  <td class="px-6 py-3">Revina</td>
                  <td class="px-6 py-3">Learning</td>
                  <td class="px-6 py-3 text-center">16</td>
                  <td class="px-6 py-3 text-center">2</td>
                  <td class="px-6 py-3 text-center">10</td>
                  <td class="px-6 py-3 text-center">4</td>
                  <td class="px-6 py-3 text-center">8.0</td>
                </tr>

                <tr data-date="2025-05-11">
                  <td class="px-6 py-3">Janter Sinaga</td>
                  <td class="px-6 py-3">Learning</td>
                  <td class="px-6 py-3 text-center">16</td>
                  <td class="px-6 py-3 text-center">4</td>
                  <td class="px-6 py-3 text-center">11</td>
                  <td class="px-6 py-3 text-center">1</td>
                  <td class="px-6 py-3 text-center">7.0</td>
                </tr>
              </tbody>
            </table>
          </div>

          <aside class="lg:col-span-3 card p-4 bg-[#DFF5E1]">
            <h4 class="font-semibold mb-3">Progress Tim</h4>
            <div class="space-y-4">
              <div class="flex items-center gap-3">
                <img
                  class="w-8 h-8 rounded-full"
                  src="https://i.pravatar.cc/60?u=1"
                  alt="a"
                />
                <div class="flex-1">
                  <div class="text-sm font-medium">Wardah Cahyani</div>
                  <div class="mt-2">
                    <div class="progress-mini">
                      <div
                        class="fill"
                        style="width: 76%; background: #4d4d4d"
                      ></div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="flex items-center gap-3">
                <img
                  class="w-8 h-8 rounded-full"
                  src="https://i.pravatar.cc/60?u=2"
                  alt="a"
                />
                <div class="flex-1">
                  <div class="text-sm font-medium">Ervia Oktaviani</div>
                  <div class="mt-2">
                    <div class="progress-mini">
                      <div
                        class="fill"
                        style="width: 94%; background: #4d4d4d"
                      ></div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="flex items-center gap-3">
                <img
                  class="w-8 h-8 rounded-full"
                  src="https://i.pravatar.cc/60?u=3"
                  alt="a"
                />
                <div class="flex-1">
                  <div class="text-sm font-medium">Janter Sinaga</div>
                  <div class="mt-2">
                    <div class="progress-mini">
                      <div
                        class="fill"
                        style="width: 48%; background: #4d4d4d"
                      ></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </aside>
        </div>

        <!-- feedback list (kept simple) -->
        <div class="mt-6">
          <div class="card overflow-hidden">
            <div
              class="bg-[color:var(--brand)] text-white px-4 py-3 font-semibold"
            >
              Feedback Team Leader
            </div>
            <div class="px-4 py-3">
              <ul class="divide-y">
                <li class="py-3 flex justify-between items-center">
                  <div>
                    <div class="font-semibold">Wardah Cahyani</div>
                    <div class="text-sm text-gray-600">
                      Alur Proses Penjualan dan Pelunasan Piutang
                    </div>
                  </div>
                  <button
                    class="px-3 py-1 rounded bg-red-600 text-white text-sm"
                  >
                    Menunggu Penilaian
                  </button>
                </li>
                <li class="py-3 flex justify-between items-center">
                  <div>
                    <div class="font-semibold">Sarah Amelia</div>
                    <div class="text-sm text-gray-600">
                      Alur Proses Penjualan
                    </div>
                  </div>
                  <button
                    class="px-3 py-1 rounded bg-emerald-500 text-white text-sm"
                  >
                    Penilaian Selesai
                  </button>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </section>
    </main>

    <script>
      /* -------------------------
         Utility parse helpers
         ------------------------- */
      function parseNumber(value) {
        if (value === null || value === undefined) return 0;
        const s = String(value)
          .trim()
          .replace(",", ".")
          .replace(/[^0-9.\-]/g, "");
        if (s === "") return 0;
        const f = parseFloat(s);
        return isNaN(f) ? 0 : f;
      }

      /* -------------------------
         Donut chart initialization
         ------------------------- */
      let donutChart = null;
      function initDonut() {
        const ctx = document.getElementById("donutChart").getContext("2d");
        donutChart = new Chart(ctx, {
          type: "doughnut",
          data: {
            labels: ["Selesai", "Berlangsung", "Belum Mulai"],
            datasets: [
              {
                data: [0, 0, 0],
                backgroundColor: ["#388E3C", "#FFB300", "#A80308"],
                borderWidth: 0,
              },
            ],
          },
          options: {
            cutout: "70%",
            maintainAspectRatio: false,
            plugins: {
              legend: { display: false },
              tooltip: {
                callbacks: { label: (ctx) => `${ctx.label}: ${ctx.raw}` },
              },
            },
          },
        });
      }

      function updateDonut(newData) {
        if (!donutChart) initDonut();
        donutChart.data.datasets[0].data = newData;
        donutChart.update();
      }

      /* -------------------------
         Compute totals from table
         ------------------------- */
      function computeFromTable() {
        const tbody = document.getElementById("membersTbody");
        if (!tbody) return;
        const rows = Array.from(tbody.querySelectorAll("tr"));
        let totalHarus = 0,
          totalBelum = 0,
          totalBerlangsung = 0,
          totalSelesai = 0;
        let sumScore = 0,
          scoreCount = 0,
          visibleRows = 0;

        rows.forEach((row) => {
          // only visible rows count (filter may hide rows with display:none)
          if (row.style.display === "none") return;
          visibleRows++;
          const tds = row.querySelectorAll("td");
          const vHarus = parseNumber(tds[2]?.textContent);
          const vBelum = parseNumber(tds[3]?.textContent);
          const vBerlangsung = parseNumber(tds[4]?.textContent);
          const vSelesai = parseNumber(tds[5]?.textContent);
          const vNilai = parseNumber(tds[6]?.textContent);

          totalHarus += vHarus;
          totalBelum += vBelum;
          totalBerlangsung += vBerlangsung;
          totalSelesai += vSelesai;
          if (!isNaN(vNilai) && String(tds[6]?.textContent || "") !== "") {
            sumScore += vNilai;
            scoreCount++;
          }
        });

        const capaianPct =
          totalHarus > 0 ? Math.round((totalSelesai / totalHarus) * 100) : 0;
        const avgScore = scoreCount > 0 ? sumScore / scoreCount : 0;

        // update stat cards
        document.getElementById("stat-team").textContent = visibleRows;
        document.getElementById("stat-running").textContent = totalBerlangsung;
        document.getElementById("stat-progress").textContent = capaianPct + "%";
        document.getElementById("stat-score").textContent = avgScore.toFixed(2);

        // update donut: [selesai, berlangsung, belum]
        updateDonut([totalSelesai, totalBerlangsung, totalBelum]);

        return {
          totalHarus,
          totalBelum,
          totalBerlangsung,
          totalSelesai,
          capaianPct,
          avgScore,
          visibleRows,
        };
      }

      /* -------------------------
         Observe table mutations
         ------------------------- */
      function observeTableMutations() {
        const tbody = document.getElementById("membersTbody");
        if (!tbody) return;
        const mo = new MutationObserver(() => {
          // recompute when rows or cells change
          computeFromTable();
        });
        mo.observe(tbody, {
          childList: true,
          subtree: true,
          characterData: true,
        });
      }

      /* -------------------------
         Progress wrappers (cards/courses)
         ------------------------- */
      function parseProgressText(text) {
        const m = String(text).match(/(\d+)\s*\/\s*(\d+)/);
        if (!m) return null;
        return [parseInt(m[1], 10), parseInt(m[2], 10)];
      }
      function updateProgressWrappers() {
        const wrappers = document.querySelectorAll(".progress-wrapper");
        wrappers.forEach((wrapper) => {
          const span = wrapper.querySelector(".progress-text");
          const fill = wrapper.querySelector(".progress-fill");
          if (!span || !fill) return;
          const nums = parseProgressText(span.textContent || "");
          if (!nums) {
            fill.style.width = "0%";
            return;
          }
          const [cur, total] = nums;
          let pct = total === 0 ? 0 : (cur / total) * 100;
          pct = Math.max(0, Math.min(100, pct));
          fill.style.width = Math.round(pct * 100) / 100 + "%";
        });
      }

      /* -------------------------
         Date range filter (flatpickr)
         ------------------------- */
      const fp = flatpickr("#dateRange", {
        mode: "range",
        dateFormat: "Y-m-d",
        altInput: true,
        altFormat: "d M Y",
        allowInput: true,
      });

      function parseRowDate(dateStr) {
        if (!dateStr) return null;
        const p = dateStr.split("-");
        if (p.length !== 3) return null;
        return new Date(Number(p[0]), Number(p[1]) - 1, Number(p[2]));
      }

      function filterTableByRange(start, end) {
        const tbody = document.getElementById("membersTbody");
        if (!tbody) return;
        const rows = Array.from(tbody.querySelectorAll("tr"));
        rows.forEach((row) => {
          const d = row.getAttribute("data-date");
          if (!d) {
            row.style.display = "";
            return;
          }
          const rd = parseRowDate(d);
          if (!rd) {
            row.style.display = "";
            return;
          }
          const visible = !start || !end ? true : rd >= start && rd <= end;
          row.style.display = visible ? "" : "none";
        });
        // recompute after filter
        computeFromTable();
      }

      document.getElementById("applyRange").addEventListener("click", () => {
        const sel = fp.selectedDates;
        if (!sel || sel.length === 0) {
          alert("Pilih rentang tanggal terlebih dahulu.");
          return;
        }
        const start = new Date(
          sel[0].getFullYear(),
          sel[0].getMonth(),
          sel[0].getDate()
        );
        const end = sel[1]
          ? new Date(sel[1].getFullYear(), sel[1].getMonth(), sel[1].getDate())
          : start;
        filterTableByRange(start, end);
      });

      document.getElementById("clearRange").addEventListener("click", () => {
        fp.clear();
        filterTableByRange(null, null);
      });

      /* -------------------------
         Optional: simple search for course cards (kept from original)
         ------------------------- */
      function attachSearchHandler() {
        const searchInput = document.getElementById("searchInput");
        const grid = document.getElementById("doneGrid");
        if (!searchInput || !grid) return;
        const items = Array.from(grid.children || []);
        searchInput.addEventListener("input", function () {
          const q = this.value.toLowerCase();
          items.forEach((card) => {
            const title =
              card.querySelector(".text-2xl")?.textContent?.toLowerCase() || "";
            card.style.display = !q || title.includes(q) ? "" : "none";
          });
        });
      }

      /* -------------------------
         Init on DOM ready
         ------------------------- */
      document.addEventListener("DOMContentLoaded", () => {
        initDonut();
        computeFromTable();
        observeTableMutations();
        updateProgressWrappers();
        attachSearchHandler();
      });

      // Expose helper for debugging
      window.computeFromTable = computeFromTable;
    </script>
  </body>
</html>
